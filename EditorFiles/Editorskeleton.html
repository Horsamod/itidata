else if (mode === 'word') {
// Split text into words while preserving newlines and spaces
const wordRegex = /(\S+|\n)/g;
const words = [];
let match;
while ((match = wordRegex.exec(text)) !== null) {
words.push(match[0]);
}

const delayPerWord = delay;
let currentText = '';

for (let i = 0; i < words.length && !stopTyping; i++) {
if (isPaused) await new Promise(resolve => { typingPromise = resolve; });

currentText += words[i];
// Add space after words unless it's a newline or last word
if (words[i]